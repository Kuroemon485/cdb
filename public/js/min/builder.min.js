!function(t){var a=(t("#pkm-pkdx_id"),t("input#is-shiny")),e=t(".data-modal"),i=t('[data-toggle="modal"]'),s="pkm-1",n=t("#data-container"),r="",o=(t('#data-container [data-toggle="fill-data"]'),t(".modal-title"));team=new Object;var c=function(a){return t.ajax({url:base_url+"teambuilder/get_species_info",type:"post",dataType:"json",data:{species_id:a}})},l=function(){return t(".tab-pane.active").attr("data-tab-number")},p=function(){return t('[data-tab-number="'+l()+'"]').find("select.pkm-list").val()},d=function(a){t('#team-tab a[href="#'+a+'"]').tab("show")},u=function(a,e){var i=0,s=t("#pkm-"+a);t.each(stats,function(n,r){t("#p"+a+"-base-"+r,s).removeClass(),t("#p"+a+"-base-"+r+"-bar",s).removeClass();var o=1*e["base_"+r],c="",l="badge bg-",p="progress-bar progress-bar-";i+=o,90>o?c="yellow":o>=90&&110>=o?c="green":o>110&&150>o?c="blue":o>=150&&(c="red"),l+=c,p+=c,t("#p"+a+"-base-"+r,s).text(o).addClass(l),t("#p"+a+"-base-"+r+"-bar",s).css("width",o/250*100+"%").addClass(p)}),t("#p"+a+"-tbs",s).text(i)},m=function(a){var e={};return t.each(stats,function(t,i){var s=1*a["base"+i],n=1*a["ev"+i],r=1*a["iv"+i],o=nmod_calc(a.nature,i),c=a.lv;stat="hp"==i?Math.floor((2*s+r+n/4)*c/100+10+1*c):Math.floor(((2*s+r+n/4)*c/100+5)*o),e[i]=stat}),e},b=function(t){o.empty().append(t)},g=function(a,e){return t.ajax({url:base_url+"common/get_modal_data",type:"post",dataType:"json",async:!1,data:{id:a,data_type:e}})};t(function(){localStorage.getItem("teamdata")&&console.log(process_team_str(localStorage.getItem("teamdata"))),t(".selectpicker").selectpicker({style:"btn-sm btn-primary",size:8}),n.slimscroll({height:"450px",alwaysVisible:!1,wheelStep:1,size:"3px"}),t(".form-control","#"+s).on("change",function(){t(this)}),t(".see-pkm").on("click",function(){s=t(this).attr("data-tab"),d(s)}),i.on("focus",function(){s_id=p(),property=t(this).attr("data-input"),r=t(this),""!=s_id&&(g(s_id,property).success(function(t){n.empty().append(t.html),b(t.title)}),e.modal("show"))}),e.on("click",'[data-toggle="fill-data"]',function(){var a=t(this).attr("data-name");r.val(a).trigger("change"),e.modal("hide")}),t(".pkm-list").on("change",function(){var a=t(".tab-pane.active").attr("data-tab-number"),e=t(this),i=t("option:selected",e).text(),s=e.val();c(s).success(function(t){u(a,t)}),""!=e.val()?(t("#p"+a+"-img").attr("src",base_url+"public/images/f-sprite/"+i+".gif"),t("#p"+a+"-ico").attr("src",base_url+"public/images/minisprites/"+i+".png")):(t("#p"+a+"-img").attr("src",base_url+"public/images/f-sprite/egg.png"),t("#p"+a+"-ico").attr("src",base_url+"public/images/minisprites/ani-egg.png"))}),t(".input-ev, .input-iv, .input-nature, .input-lv").on("change",function(){var a={},e=l();t.each(stats,function(i,s){a["base"+s]=t("#p"+e+"-base-"+s).text(),a["iv"+s]=t("#p"+e+"-iv-"+s).val(),a["ev"+s]=t("#p"+e+"-ev-"+s).val()}),a.nature=t("#p"+e+"-nature").val(),a.lv=t("#p"+e+"-lv").val(),console.log(a);var i=m(a);console.log(i),t.each(stats,function(a,s){t("#p"+e+"-total-"+s).text(i[s])})}),t("#ie-button").on("click",function(){t(".ie-modal textarea").val(""),t(".ie-modal").modal("show")}),t("#import-btn").on("click",function(){rawdata=t(".ie-modal textarea").val(),""!=rawdata&&(localStorage.setItem("teamdata",rawdata),console.log(process_team_str(rawdata)),t(".ie-modal").modal("hide"))}),a.on("ifChecked",function(){var a=t(this).attr("data-species");""!=a&&t(".pkm-sprite").attr("src",base_url+"public/images/f-sprite-shiny/"+a+".gif")}),a.on("ifUnchecked",function(){var a=t(this).attr("data-species");""!=a&&t(".pkm-sprite").attr("src",base_url+"public/images/f-sprite/"+a+".gif")})})}(window.jQuery,window,document);